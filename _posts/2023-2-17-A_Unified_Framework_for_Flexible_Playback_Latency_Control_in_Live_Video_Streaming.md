# A Unified Framework for Flexible Playback Latency Control in Live Video Streaming

# Abstract

        直播流中的一个重要事实是，对低播放延迟的需求与对高QoE的需求本质上是冲突的。这需要不同类型的实时服务根据其服务需求寻求不同的延迟QoE权衡。然而，我们的调查表明，现有的流算法在不断变化的网络条件下保持一致的延迟是根本困难的，更不用说实现服务所需的延迟QoE权衡了。为了应对这一挑战，本文开发了一种称为灵活延迟感知流（FLAS）的新框架，该框架不仅可以实现一致的低延迟，而且可以灵活地控制延迟QoE权衡。具体地说，FLAS离线生成一组自适应逻辑，每个逻辑都针对候选权衡点进行了优化，然后选择最合适的逻辑在线运行。我们首先展示了FLAS如何应用于优化现有算法，然后开发了一种新的遗传编程方法来充分利用FLAS的潜力。广泛的评估表明，FLAS可以精确地将延迟控制到1秒，并实现比现有技术高得多的QoE。FLAS可以很容易地实现到真实的流媒体平台中，为实时流媒体服务提供了实用可靠的解决方案。

        视频流已成为互联网的主流应用。从流式传输预编码内容（即按需流式传输）开始，近年来的一个新趋势是将现场活动从专业创作的现场内容（如新闻、音乐会和体育）流式传输到用户生成的现场流（如个人现场秀）。YouTube live[1]和Facebook live[2]等直播平台的广泛采用进一步推动了这一趋势。

        除了视频质量和回放重新缓冲等通常的体验质量（QoE）指标外，直播流媒体中一个独特且重要的性能指标是playback latency，其定义为视频渲染和实际捕获之间的时间差。在本文中，延迟不包括在QoE的计算中，以便将其与通常的QoE区分开来。

        一般来说，直播流媒体需要较低的playback latency（最多几秒），否则服务质量将显著下降。然而，事实上，延迟和QoE（例如，视频质量）本质上是相互冲突的目标。例如，观众通常更喜欢流式传输高质量视频，这将不可避免地在移动无线电链路上产生更长的传输延迟。由于传输延迟直接转化为playback latency，因此对高质量视频的需求与低延迟需求固有地冲突。因此，这需要实时流服务在延迟和QoE之间寻求性能平衡。

        实际上，不同类型的直播流服务可能具有非常不同的延迟QoE要求。例如，高度交互式的直播流（例如，现场销售、交互式直播节目）比单向广播（例如，新闻、音乐会）需要更短的延迟，但交互式流可以容忍更低的视频质量。因此，如何为不同的实时服务实现期望的和最佳的延迟QoE权衡是设计流算法的一个重大挑战。

        我们的调查显示，这些现有算法实现的playback latency差距很大，在变化的网络条件下，playback latency会在在很大范围内（例如，2s-31s）发生变化。换言之，根据所经历的特定网络条件，从同一移动运营商（即使在同一位置）流式传输相同的视频可能会导致显著不同的延迟。

        为了应对这一挑战，我们提出了一种称为灵活延迟感知流（Flexible Latency Aware Streaming，FLAS）的新框架，该框架不仅可以实现一致的低延迟，而且可以灵活地控制延迟QoE权衡。具体而言，FLAS引入了状态量化器（SQ）的概念来量化延迟QoE权衡，然后离线生成一组自适应逻辑，其中每一个都针对候选权衡点进行优化。在运行时，允许服务提供商（或观众）根据服务要求指定目标回放延迟（例如，2s）。在规定了目标延迟的情况下，FLAS然后基于网络条件周期性地选择/调整操作自适应逻辑，以确保实际延迟不会偏离目标，同时QoE可以最大化。

**贡献**：

    1）进行了广泛的评估，以揭示现有直播流算法的问题

    2）提出了FLAS，可以优化现有的基于学习的算法。将FLAS应用于L2AC，这是在A3C基础上开发的最先进算法。然而，我们发现，尽管FLAS-L2AC可以实现显著更好的性能，但其效率在具有挑战性的网络条件下受到限制，这可能是由于固有的神经网络结构或训练参数。

    3）为了摆脱这种限制，我们转而使用一种完全不同的机器学习方法——Genetic
Programming（GP）。与深度强化学习不同，GP以表达式树的形式表示候选解决方案，并且不在树上强加任何刚性结构，因此可以自由探索解决方案空间。

**FLAS-GP优势**：

    1）可以以与现有技术相同或更低的playback latency实现显著更高的QoE；

    2） 可以精确地将延迟控制到1秒；

    3） 表现出显著的空间和时间鲁棒性；

    4）易于部署在真实的流媒体平台上。

# 2、Background and related work

        动态自适应视频流（Dynamic adaptive video streaming，DASH）是服务提供商用来补偿网络中不可避免的带宽波动的主要工具。近年来，研究人员开发了许多用于点播流的新型自适应流算法。基本原理是根据过去的测量（如吞吐量和缓冲区占用率）动态选择未来的视频比特率。现有自适应算法可以基于其测量的度量进行分类，例如基于带宽的、基于缓冲区的和基于混合带宽缓冲区的方法，或者根据用于优化自适应逻辑的技术进行分类，数据分析和机器学习。

        虽然DASH在按需流媒体上运行良好，但由于其基于分段的视频传输，其延迟太长，不适合实时流媒体。为了解决这个问题，最近提出的CMAF[40]，[43]支持将DASH片段划分为独立可转移的块，这为研究人员开发新的实时流媒体自适应算法提供了动力。

## 直播流中存在的问题

        首先，由于数据缓冲会直接增加playback latency，这促使设计人员控制流传输管道中缓冲的数据量以减少延迟。

        第二个问题是延迟累积。具体而言，在播放器耗尽视频数据的重新缓冲期间，视频播放将被暂停，直到下载足够的数据以恢复播放。另一方面，现场事件会继续进行，因此视频播放和实际拍摄之间的差距将因重新缓冲事件而扩大。考虑到视频数据是按顺序播放的，一旦引入，延迟就无法减少，因此每当发生重新缓冲事件时，延迟就会增加。

        解决这个问题的两个常见方法是视频跳过和播放速率调节。前者是跳过延迟到达的视频片段的下载/播放，而后者是加速播放。

## FLAS的优势

1）除了在不同网络条件下实现一致的低延迟外，FLAS还可以实现灵活的延迟控制；

2） FLAS是一个通用框架，它不仅可以应用于优化现有算法，还可以指导新的延迟感知方法的设计。

3） FLAS的两阶段设计避免了实际部署的困难，为直播流带来了一个完全实用的解决方案。

# 3、Evaluation of Existing Algorithms

        在本节中，我们评估了五种主流直播算法的性能，然后讨论了它们的局限性。

## 3.1 Experiment Setup

<img title="" src="file:///F:/qiqiblog.github.io/images/2023-2-17-A_Unified_Framework_for_Flexible_Playback_Latency_Control_in_Live_Video_Streaming/Statistics%20of%20Seven%20Throughput%20Trace%20Datasets.png" alt="avatar" data-align="center" width="400">

## 3.2 Results and Discussions
